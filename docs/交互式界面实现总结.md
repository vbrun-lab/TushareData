# äº¤äº’å¼ç•Œé¢å®ç°æ€»ç»“

## æ¦‚è¿°
æœ¬æ–‡æ¡£æ€»ç»“äº†TushareDataé¡¹ç›®ä¸­äº¤äº’å¼ç•Œé¢çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä¼ ç»Ÿäº¤äº’å¼èœå•å’Œç°ä»£å‘½ä»¤è¡Œæ¥å£çš„è®¾è®¡ã€‚è¯¥å®ç°æ–¹æ¡ˆå¯ä½œä¸ºPythoné¡¹ç›®ç”¨æˆ·ç•Œé¢å¼€å‘çš„å‚è€ƒæ¨¡æ¿ã€‚

## é¡¹ç›®æ¶æ„æ¦‚è§ˆ

### æ ¸å¿ƒç»„ä»¶
1. **interactive_menu.py** - åŸºç¡€äº¤äº’å¼èœå•ç±»
2. **start.py** - å‘½ä»¤è¡Œå¢å¼ºå¯åŠ¨å™¨
3. **main.py** - å®Œæ•´å‘½ä»¤è¡Œæ¥å£

### è®¾è®¡ç†å¿µ
- **åˆ†ç¦»å…³æ³¨ç‚¹**ï¼šç•Œé¢é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘å®Œå…¨åˆ†ç¦»
- **ç»§æ‰¿æ‰©å±•**ï¼šé€šè¿‡ç»§æ‰¿å®ç°åŠŸèƒ½å¢å¼º
- **é…ç½®é©±åŠ¨**ï¼šèœå•é€‰é¡¹å’Œè¡Œä¸ºé€šè¿‡é…ç½®æ§åˆ¶
- **å‘åå…¼å®¹**ï¼šæ–°åŠŸèƒ½ä¸ç ´ååŸæœ‰ä½¿ç”¨æ–¹å¼

## ä¸€ã€åŸºç¡€äº¤äº’å¼èœå•å®ç° (interactive_menu.py)

### 1.1 æ ¸å¿ƒæ¶æ„è®¾è®¡

```python
class InteractiveMenu:
    """äº¤äº’å¼èœå•åŸºç±»"""
    
    def __init__(self, config_file: str = 'config.json'):
        self.config_file = config_file
        self.downloader = None
        self.menu_options = self._setup_menu_options()
```

**è®¾è®¡ç‰¹ç‚¹ï¼š**
- å»¶è¿Ÿåˆå§‹åŒ–ï¼šdownloaderåœ¨éœ€è¦æ—¶æ‰åˆ›å»º
- é…ç½®åŒ–èœå•ï¼šé€šè¿‡å­—å…¸å®šä¹‰èœå•ç»“æ„
- èŒè´£å•ä¸€ï¼šä¸“æ³¨äºç•Œé¢äº¤äº’é€»è¾‘

### 1.2 èœå•é…ç½®ç³»ç»Ÿ

```python
def _setup_menu_options(self) -> Dict[str, Dict]:
    """é…ç½®åŒ–èœå•é€‰é¡¹å®šä¹‰"""
    return {
        '1': {
            'title': 'æ›´æ–°åŸºç¡€æ•°æ®ï¼ˆè‚¡ç¥¨åˆ—è¡¨ã€åŸºé‡‘åˆ—è¡¨ã€äº¤æ˜“æ—¥å†ï¼‰',
            'function': self._update_reference_data,
            'description': 'ä¸‹è½½æœ€æ–°çš„è‚¡ç¥¨åˆ—è¡¨ã€åŸºé‡‘åˆ—è¡¨å’Œäº¤æ˜“æ—¥å†'
        },
        '2': {
            'title': 'ETFæ—¥çº¿æ•°æ®ä¸‹è½½',
            'function': self._download_etf_daily,
            'description': 'ä¸‹è½½æ‰€æœ‰ETFçš„æ—¥çº¿è¡Œæƒ…æ•°æ®'
        },
        # ... æ›´å¤šé€‰é¡¹
        '0': {
            'title': 'é€€å‡ºç¨‹åº',
            'function': self._exit_program,
            'description': 'é€€å‡ºæ•°æ®ä¸‹è½½ç¨‹åº'
        }
    }
```

**ä¼˜åŠ¿ï¼š**
- **æ˜“äºç»´æŠ¤**ï¼šæ–°å¢åŠŸèƒ½åªéœ€æ·»åŠ å­—å…¸é¡¹
- **ç»Ÿä¸€ç»“æ„**ï¼šæ‰€æœ‰èœå•é¡¹ä½¿ç”¨ç›¸åŒçš„æ•°æ®æ ¼å¼
- **åŠ¨æ€æ‰©å±•**ï¼šå­ç±»å¯ä»¥é‡å†™æ­¤æ–¹æ³•æ‰©å±•èœå•

### 1.3 ç”¨æˆ·ç•Œé¢è®¾è®¡

#### ç•Œé¢æ¸²æŸ“ç³»ç»Ÿ
```python
def _print_header(self):
    """ç¨‹åºå¤´éƒ¨è®¾è®¡"""
    print("=" * 60)
    print("ğŸš€ Aè‚¡é‡åŒ–æ•°æ®ä¸‹è½½ç¨‹åº")
    print("=" * 60)
    print("åŸºäºTushareæ¥å£çš„ä¸“ä¸šæ•°æ®ä¸‹è½½å·¥å…·")
    print("æ”¯æŒè‚¡ç¥¨ã€ETFã€æŒ‡æ•°çš„æ—¥çº¿å’Œåˆ†é’Ÿçº¿æ•°æ®")
    print("-" * 60)

def _print_menu(self):
    """èœå•é€‰é¡¹æ¸²æŸ“"""
    print("\nğŸ“‹ è¯·é€‰æ‹©ä¸‹è½½ä»»åŠ¡:")
    print("-" * 60)
    
    for key, option in self.menu_options.items():
        if key == '0':
            print()  # é€€å‡ºé€‰é¡¹å‰åŠ ç©ºè¡Œ
        print(f"[{key}] {option['title']}")
        print(f"    {option['description']}")
    
    print("-" * 60)
    print("ğŸ’¡ æç¤ºï¼šå¯ä»¥è¾“å…¥å¤šä¸ªé€‰é¡¹ç¼–å·è¿›è¡Œæ‰¹é‡æ‰§è¡Œï¼Œå¦‚ '12340' è¡¨ç¤ºä¾æ¬¡æ‰§è¡Œé€‰é¡¹1ã€2ã€3ã€4")
```

**è®¾è®¡äº®ç‚¹ï¼š**
- **è§†è§‰å±‚æ¬¡**ï¼šä½¿ç”¨emojiå’Œåˆ†éš”çº¿å¢å¼ºå¯è¯»æ€§
- **ä¿¡æ¯ä¸°å¯Œ**ï¼šæ¯ä¸ªé€‰é¡¹éƒ½æœ‰è¯¦ç»†æè¿°
- **æ“ä½œæç¤º**ï¼šå†…ç½®ä½¿ç”¨è¯´æ˜

#### ç”¨æˆ·è¾“å…¥å¤„ç†
```python
def _get_user_choice(self) -> str:
    """æ™ºèƒ½ç”¨æˆ·è¾“å…¥å¤„ç†"""
    while True:
        choice = input("\nè¯·è¾“å…¥é€‰é¡¹ç¼–å· (0-9,a) æˆ–å­—ç¬¦åºåˆ— (å¦‚12340): ").strip()
        
        # è¾“å…¥éªŒè¯
        if not choice:
            print("âŒ è¯·è¾“å…¥é€‰é¡¹ç¼–å·")
            continue
        
        # å­—ç¬¦éªŒè¯
        valid_choices = []
        invalid_chars = []
        
        for char in choice:
            if char in self.menu_options:
                valid_choices.append(char)
            else:
                invalid_chars.append(char)
        
        if invalid_chars:
            print(f"âŒ æ— æ•ˆå­—ç¬¦: {', '.join(invalid_chars)}ï¼Œè¯·è¾“å…¥æœ‰æ•ˆçš„é€‰é¡¹ç¼–å· (0-9,a)")
            continue
            
        return choice
```

**ç‰¹æ€§ï¼š**
- **æ‰¹é‡è¾“å…¥æ”¯æŒ**ï¼šæ”¯æŒè¿ç»­å­—ç¬¦ä¸²å¦‚"12340"
- **è¾“å…¥éªŒè¯**ï¼šå®æ—¶éªŒè¯æ¯ä¸ªå­—ç¬¦çš„æœ‰æ•ˆæ€§
- **é”™è¯¯æç¤º**ï¼šæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œé‡è¯•æœºåˆ¶

### 1.4 æ‰¹é‡æ‰§è¡Œæœºåˆ¶

```python
def _execute_batch_choices(self, choices: str):
    """æ‰¹é‡æ‰§è¡Œç®¡ç†"""
    total = len(choices)
    
    for i, choice in enumerate(choices, 1):
        option = self.menu_options[choice]
        
        print(f"\n{'='*60}")
        print(f"ğŸ”„ æ‰§è¡Œç¬¬ {i}/{total} ä¸ªæ“ä½œ: [{choice}] {option['title']}")
        print(f"{'='*60}")
        
        # æ‰¹é‡æ¨¡å¼æ ‡å¿—
        self._batch_mode = True
        
        try:
            option['function']()
            print(f"âœ… ç¬¬ {i}/{total} ä¸ªæ“ä½œå®Œæˆ")
        except Exception as e:
            print(f"âŒ æ“ä½œå¤±è´¥: {e}")
```

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- **è¿›åº¦æ˜¾ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºæ‰§è¡Œè¿›åº¦
- **æ‰¹é‡æ¨¡å¼æ ‡å¿—**ï¼šå­å‡½æ•°å¯ä»¥æ£€æµ‹æ‰¹é‡æ‰§è¡ŒçŠ¶æ€
- **é”™è¯¯éš”ç¦»**ï¼šå•ä¸ªæ“ä½œå¤±è´¥ä¸å½±å“åç»­æ‰§è¡Œ

### 1.5 ç¡®è®¤æœºåˆ¶è®¾è®¡

```python
def _confirm_action(self, action_description: str) -> bool:
    """æ“ä½œç¡®è®¤æœºåˆ¶"""
    # æ‰¹é‡æ¨¡å¼ä¸‹è·³è¿‡ç¡®è®¤
    if self._is_batch_mode():
        return True
    
    print(f"\nğŸ“Œ å³å°†æ‰§è¡Œ: {action_description}")
    while True:
        confirm = input("ç¡®è®¤æ‰§è¡Œå—ï¼Ÿ(y/n): ").strip().lower()
        if confirm in ['y', 'yes', 'æ˜¯', 'ç¡®è®¤']:
            return True
        elif confirm in ['n', 'no', 'å¦', 'å–æ¶ˆ']:
            return False
        else:
            print("è¯·è¾“å…¥ y/n æˆ– æ˜¯/å¦")
```

**æ™ºèƒ½ç¡®è®¤ï¼š**
- **æ‰¹é‡æ¨¡å¼ä¼˜åŒ–**ï¼šæ‰¹é‡æ‰§è¡Œæ—¶è‡ªåŠ¨è·³è¿‡ç¡®è®¤
- **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒä¸­è‹±æ–‡ç¡®è®¤è¾“å…¥
- **å¾ªç¯éªŒè¯**ï¼šç¡®ä¿ç”¨æˆ·è¾“å…¥æœ‰æ•ˆ

## äºŒã€å‘½ä»¤è¡Œå¢å¼ºå®ç° (start.py)

### 2.1 åŠ¨æ€å‚æ•°è¯†åˆ«

```python
def parse_arguments():
    """åŠ¨æ€å‘½ä»¤è¡Œå‚æ•°è§£æ"""
    parser = argparse.ArgumentParser(
        description='Aè‚¡é‡åŒ–æ•°æ®ä¸‹è½½ç¨‹åº - å‘½ä»¤è¡Œå¯åŠ¨å™¨',
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
ä½¿ç”¨ç¤ºä¾‹:
  python start.py                    # å¯åŠ¨äº¤äº’å¼èœå•
  python start.py --incremental      # è®¾ç½®å¢é‡æ¨¡å¼å¹¶å¯åŠ¨èœå•
  python start.py --123450           # è‡ªåŠ¨æ‰§è¡Œèœå•åºåˆ— 1,2,3,4,5,0
  python start.py --incremental --12a0  # å¢é‡æ¨¡å¼ + è‡ªåŠ¨æ‰§è¡Œåºåˆ—
        """
    )
    
    # åŸºç¡€å‚æ•°
    parser.add_argument('--config', '-c', default='config.json',
                       help='é…ç½®æ–‡ä»¶è·¯å¾„ (é»˜è®¤: config.json)')
    
    # æ¨¡å¼å‚æ•°
    mode_group = parser.add_mutually_exclusive_group()
    mode_group.add_argument('--incremental', action='store_true',
                           help='è®¾ç½®ä¸ºå¢é‡æ›´æ–°æ¨¡å¼')
    mode_group.add_argument('--full', action='store_true',
                           help='è®¾ç½®ä¸ºå…¨é‡ä¸‹è½½æ¨¡å¼')
    mode_group.add_argument('--custom', action='store_true',
                           help='è®¾ç½®ä¸ºè‡ªå®šä¹‰æ¨¡å¼')
    
    # åŠ¨æ€åºåˆ—å‚æ•°è¯†åˆ«
    for i, arg in enumerate(sys.argv):
        if arg.startswith('--') and len(arg) > 2:
            potential_seq = arg[2:]  # å»æ‰ --
            if (potential_seq and 
                all(c.isdigit() or c.lower() in 'abcdefghijklmnopqrstuvwxyz' for c in potential_seq) and
                arg not in ['--config', '--incremental', '--full', '--custom', '--auto', '--sequence', '--seq', '--help']):
                # åŠ¨æ€æ·»åŠ åºåˆ—å‚æ•°
                parser.add_argument(arg, action='store_const', const=potential_seq,
                                   help=f'è‡ªåŠ¨æ‰§è¡Œèœå•åºåˆ—: {potential_seq}')
    
    return parser.parse_args()
```

**åˆ›æ–°ç‰¹æ€§ï¼š**
- **åŠ¨æ€å‚æ•°è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ«`--123450`æ ¼å¼çš„å‚æ•°
- **å‚æ•°éªŒè¯**ï¼šç¡®ä¿åºåˆ—å­—ç¬¦éƒ½æ˜¯æœ‰æ•ˆçš„èœå•é€‰é¡¹
- **å¸®åŠ©æ–‡æ¡£**ï¼šåŠ¨æ€ç”Ÿæˆçš„å‚æ•°ä¹Ÿä¼šå‡ºç°åœ¨å¸®åŠ©ä¿¡æ¯ä¸­

### 2.2 é…ç½®æ–‡ä»¶åŠ¨æ€ä¿®æ”¹

```python
def modify_config_mode(config_file: str, mode: str) -> str:
    """ä¸´æ—¶é…ç½®æ–‡ä»¶ç®¡ç†"""
    try:
        # è¯»å–åŸé…ç½®
        with open(config_file, 'r', encoding='utf-8') as f:
            config = json.load(f)
        
        # ä¿®æ”¹update_mode
        original_mode = config['date_ranges'].get('update_mode', 'incremental')
        config['date_ranges']['update_mode'] = mode
        
        print(f"ğŸ“ é…ç½®æ¨¡å¼: {original_mode} â†’ {mode}")
        
        # åˆ›å»ºä¸´æ—¶é…ç½®æ–‡ä»¶
        if original_mode != mode:
            temp_fd, temp_config_file = tempfile.mkstemp(suffix='.json', prefix='config_temp_')
            try:
                with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
                    json.dump(config, f, ensure_ascii=False, indent=2)
                print(f"ğŸ“„ ä¸´æ—¶é…ç½®æ–‡ä»¶: {temp_config_file}")
                return temp_config_file
            except Exception as e:
                os.close(temp_fd)
                os.unlink(temp_config_file)
                raise e
        
        return config_file
            
    except Exception as e:
        print(f"âŒ ä¿®æ”¹é…ç½®æ–‡ä»¶å¤±è´¥: {e}")
        return config_file
```

**å®‰å…¨è®¾è®¡ï¼š**
- **éç ´åæ€§ä¿®æ”¹**ï¼šä¸ä¿®æ”¹åŸé…ç½®æ–‡ä»¶
- **ä¸´æ—¶æ–‡ä»¶ç®¡ç†**ï¼šè‡ªåŠ¨åˆ›å»ºå’Œæ¸…ç†ä¸´æ—¶æ–‡ä»¶
- **å¼‚å¸¸å®‰å…¨**ï¼šç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾

### 2.3 è‡ªåŠ¨æ‰§è¡Œèœå•ç±»

```python
class AutoExecuteMenu(InteractiveMenu):
    """æ”¯æŒè‡ªåŠ¨æ‰§è¡Œçš„èœå•ç±»"""
    
    def __init__(self, config_file: str = 'config.json', auto_sequence: str = None):
        super().__init__(config_file)
        self.auto_sequence = auto_sequence
        self.auto_mode = bool(auto_sequence)
    
    def _auto_execute_sequence(self, sequence: str):
        """è‡ªåŠ¨æ‰§è¡Œåºåˆ—ç®¡ç†"""
        print(f"ğŸ¤– è‡ªåŠ¨æ‰§è¡Œæ¨¡å¼")
        print(f"ğŸ“‹ æ‰§è¡Œåºåˆ—: {sequence}")
        
        # åºåˆ—éªŒè¯
        valid_choices = []
        invalid_chars = []
        
        for char in sequence:
            if char in self.menu_options:
                valid_choices.append(char)
            else:
                invalid_chars.append(char)
        
        if invalid_chars:
            print(f"âŒ åºåˆ—ä¸­åŒ…å«æ— æ•ˆå­—ç¬¦: {', '.join(invalid_chars)}")
            return
        
        # æ‰§è¡Œé¢„è§ˆ
        print(f"ğŸ“‹ å°†ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œ:")
        for i, choice in enumerate(valid_choices, 1):
            option = self.menu_options[choice]
            print(f"{i}. [{choice}] {option['title']}")
        
        # æ‰¹é‡æ‰§è¡Œ
        self._batch_mode = True
        for i, choice in enumerate(valid_choices, 1):
            try:
                self.menu_options[choice]['function']()
                print(f"âœ… ç¬¬ {i}/{len(valid_choices)} ä¸ªæ“ä½œå®Œæˆ")
            except Exception as e:
                print(f"âŒ ç¬¬ {i}/{len(valid_choices)} ä¸ªæ“ä½œå¤±è´¥: {e}")
                # é”™è¯¯æ¢å¤è¯¢é—®
                if i < len(valid_choices):
                    continue_choice = input("æ˜¯å¦ç»§ç»­æ‰§è¡Œåç»­æ“ä½œï¼Ÿ(y/n): ").strip().lower()
                    if continue_choice not in ['y', 'yes', 'æ˜¯']:
                        break
```

**é«˜çº§ç‰¹æ€§ï¼š**
- **ç»§æ‰¿è®¾è®¡**ï¼šå¤ç”¨åŸºç¡€èœå•çš„æ‰€æœ‰åŠŸèƒ½
- **æ‰§è¡Œé¢„è§ˆ**ï¼šæ‰§è¡Œå‰æ˜¾ç¤ºå®Œæ•´æ“ä½œåˆ—è¡¨
- **é”™è¯¯æ¢å¤**ï¼šå•ä¸ªæ“ä½œå¤±è´¥åè¯¢é—®æ˜¯å¦ç»§ç»­

### 2.4 èµ„æºç®¡ç†

```python
def main():
    """ä¸»å‡½æ•° - å®Œæ•´çš„èµ„æºç®¡ç†"""
    args = parse_arguments()
    config_file = args.config
    temp_config_file = None
    
    try:
        # æ¨¡å¼å¤„ç†
        if args.incremental:
            config_file = modify_config_mode(args.config, 'incremental')
            temp_config_file = config_file if config_file != args.config else None
        
        # è‡ªåŠ¨æ‰§è¡Œåºåˆ—æå–
        auto_sequence = extract_sequence_from_args(args)
        
        # åˆ›å»ºå¹¶è¿è¡Œèœå•
        menu = AutoExecuteMenu(config_file, auto_sequence)
        menu.run()
        
    except KeyboardInterrupt:
        print("\n\nğŸ‘‹ ç¨‹åºè¢«ç”¨æˆ·ä¸­æ–­")
    except Exception as e:
        print(f"âŒ ç¨‹åºæ‰§è¡Œå¤±è´¥: {e}")
        sys.exit(1)
    finally:
        # èµ„æºæ¸…ç†
        if temp_config_file and temp_config_file != args.config:
            try:
                os.unlink(temp_config_file)
                print(f"ğŸ—‘ï¸ å·²æ¸…ç†ä¸´æ—¶é…ç½®æ–‡ä»¶")
            except Exception as e:
                print(f"âš ï¸ æ¸…ç†ä¸´æ—¶é…ç½®æ–‡ä»¶å¤±è´¥: {e}")
```

**èµ„æºå®‰å…¨ï¼š**
- **try-finallyä¿è¯**ï¼šæ— è®ºå¦‚ä½•éƒ½ä¼šæ¸…ç†ä¸´æ—¶æ–‡ä»¶
- **å¼‚å¸¸å¤„ç†**ï¼šåŒºåˆ†ä¸åŒç±»å‹çš„å¼‚å¸¸
- **ä¼˜é›…é€€å‡º**ï¼šCtrl+Cä¸­æ–­æ—¶çš„å‹å¥½æç¤º

## ä¸‰ã€ç”¨æˆ·ä½“éªŒè®¾è®¡åŸåˆ™

### 3.1 è§†è§‰è®¾è®¡
- **emojiå›¾æ ‡**ï¼šğŸš€ğŸ”„âœ…âŒç­‰å›¾æ ‡å¢å¼ºè§†è§‰æ•ˆæœ
- **åˆ†éš”çº¿å±‚æ¬¡**ï¼šä½¿ç”¨=å’Œ-åˆ›å»ºæ¸…æ™°çš„è§†è§‰å±‚æ¬¡
- **è¿›åº¦æ˜¾ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºæ“ä½œè¿›åº¦å’ŒçŠ¶æ€

### 3.2 äº¤äº’è®¾è®¡
- **å¤šç§è¾“å…¥æ–¹å¼**ï¼šæ”¯æŒå•é€‰ã€æ‰¹é‡ã€å‘½ä»¤è¡Œç­‰å¤šç§æ“ä½œæ–¹å¼
- **æ™ºèƒ½éªŒè¯**ï¼šå®æ—¶è¾“å…¥éªŒè¯å’Œé”™è¯¯æç¤º
- **ç¡®è®¤æœºåˆ¶**ï¼šé‡è¦æ“ä½œå‰çš„äºŒæ¬¡ç¡®è®¤

### 3.3 é”™è¯¯å¤„ç†
- **åˆ†çº§é”™è¯¯å¤„ç†**ï¼šåŒºåˆ†è­¦å‘Šã€é”™è¯¯å’Œè‡´å‘½é”™è¯¯
- **æ¢å¤æœºåˆ¶**ï¼šæä¾›é”™è¯¯åçš„æ¢å¤é€‰é¡¹
- **ç”¨æˆ·å‹å¥½**ï¼šæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³å»ºè®®

## å››ã€å¼€å‘æŒ‡å—

### 4.1 æ‰©å±•æ–°åŠŸèƒ½

#### æ·»åŠ æ–°èœå•é¡¹
```python
def _setup_menu_options(self) -> Dict[str, Dict]:
    options = super()._setup_menu_options()
    options['x'] = {
        'title': 'æ–°åŠŸèƒ½',
        'function': self._new_function,
        'description': 'æ–°åŠŸèƒ½æè¿°'
    }
    return options

def _new_function(self):
    """æ–°åŠŸèƒ½å®ç°"""
    if not self._confirm_action("æ‰§è¡Œæ–°åŠŸèƒ½"):
        return
    
    print("\nğŸ”„ æ­£åœ¨æ‰§è¡Œæ–°åŠŸèƒ½...")
    try:
        # ä¸šåŠ¡é€»è¾‘
        print("âœ… æ–°åŠŸèƒ½æ‰§è¡Œå®Œæˆ")
    except Exception as e:
        print(f"âŒ æ–°åŠŸèƒ½æ‰§è¡Œå¤±è´¥: {e}")
    
    if not self._is_batch_mode():
        input("\næŒ‰å›è½¦é”®ç»§ç»­...")
```

#### åˆ›å»ºä¸“ç”¨èœå•ç±»
```python
class CustomMenu(InteractiveMenu):
    """ä¸“ç”¨èœå•ç±»"""
    
    def __init__(self, config_file: str = 'config.json'):
        super().__init__(config_file)
        # è‡ªå®šä¹‰åˆå§‹åŒ–
    
    def _setup_menu_options(self) -> Dict[str, Dict]:
        """é‡å†™èœå•é…ç½®"""
        return {
            # è‡ªå®šä¹‰èœå•é¡¹
        }
```

### 4.2 æœ€ä½³å®è·µ

#### å‡½æ•°è®¾è®¡æ¨¡å¼
```python
def _operation_template(self):
    """æ“ä½œæ¨¡æ¿"""
    # 1. å‚æ•°è·å–ï¼ˆå¦‚æœéœ€è¦ï¼‰
    param = self._get_param_input()
    
    # 2. æ“ä½œç¡®è®¤
    if not self._confirm_action(f"æ‰§è¡Œæ“ä½œï¼ˆå‚æ•°ï¼š{param}ï¼‰"):
        return
    
    # 3. æ‰§è¡Œæç¤º
    print(f"\nğŸ”„ æ­£åœ¨æ‰§è¡Œæ“ä½œ...")
    
    # 4. ä¸šåŠ¡é€»è¾‘
    try:
        result = self.business_logic.do_operation(param)
        print(f"âœ… æ“ä½œå®Œæˆï¼š{result}")
    except Exception as e:
        print(f"âŒ æ“ä½œå¤±è´¥: {e}")
    
    # 5. æ‰¹é‡æ¨¡å¼æ£€æŸ¥
    if not self._is_batch_mode():
        input("\næŒ‰å›è½¦é”®ç»§ç»­...")
```

#### é”™è¯¯å¤„ç†ç­–ç•¥
```python
def _robust_operation(self):
    """å¥å£®çš„æ“ä½œå®ç°"""
    try:
        # é¢„æ£€æŸ¥
        if not self._pre_check():
            return
        
        # æ‰§è¡Œæ“ä½œ
        self._do_operation()
        
    except KeyboardInterrupt:
        print("\nâš ï¸ æ“ä½œè¢«ç”¨æˆ·ä¸­æ–­")
    except ValidationError as e:
        print(f"âŒ è¾“å…¥éªŒè¯å¤±è´¥: {e}")
    except BusinessError as e:
        print(f"âŒ ä¸šåŠ¡é€»è¾‘é”™è¯¯: {e}")
    except Exception as e:
        print(f"âŒ æœªçŸ¥é”™è¯¯: {e}")
        if self._debug_mode:
            import traceback
            traceback.print_exc()
```

### 4.3 å‘½ä»¤è¡Œæ‰©å±•

#### æ·»åŠ æ–°çš„å‘½ä»¤è¡Œå‚æ•°
```python
def parse_arguments():
    parser = argparse.ArgumentParser(...)
    
    # æ·»åŠ æ–°å‚æ•°
    parser.add_argument('--new-option', action='store_true',
                       help='æ–°é€‰é¡¹è¯´æ˜')
    
    return parser.parse_args()
```

#### æ‰©å±•è‡ªåŠ¨æ‰§è¡ŒåŠŸèƒ½
```python
class AdvancedAutoExecuteMenu(AutoExecuteMenu):
    """é«˜çº§è‡ªåŠ¨æ‰§è¡Œèœå•"""
    
    def _auto_execute_sequence(self, sequence: str):
        """æ‰©å±•çš„è‡ªåŠ¨æ‰§è¡Œé€»è¾‘"""
        # é¢„å¤„ç†åºåˆ—
        processed_sequence = self._preprocess_sequence(sequence)
        
        # è°ƒç”¨çˆ¶ç±»æ–¹æ³•
        super()._auto_execute_sequence(processed_sequence)
        
        # åå¤„ç†
        self._postprocess_execution()
```

## äº”ã€æŠ€æœ¯æ€»ç»“

### 5.1 æ¶æ„ä¼˜åŠ¿
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šåŠŸèƒ½æ¸…æ™°åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤
- **ç»§æ‰¿æ‰©å±•**ï¼šé€šè¿‡ç»§æ‰¿å®ç°åŠŸèƒ½å¢å¼ºè€Œä¸ç ´ååŸæœ‰ä»£ç 
- **é…ç½®é©±åŠ¨**ï¼šèœå•å’Œè¡Œä¸ºå¯é€šè¿‡é…ç½®çµæ´»è°ƒæ•´
- **å‘åå…¼å®¹**ï¼šæ–°åŠŸèƒ½ä¸å½±å“åŸæœ‰ä½¿ç”¨æ–¹å¼

### 5.2 åˆ›æ–°ç‰¹æ€§
- **åŠ¨æ€å‚æ•°è¯†åˆ«**ï¼šå‘½ä»¤è¡Œå‚æ•°å¯ä»¥åŠ¨æ€ç”Ÿæˆ
- **æ™ºèƒ½æ‰¹é‡æ‰§è¡Œ**ï¼šæ”¯æŒå¤æ‚çš„æ‰¹é‡æ“ä½œåºåˆ—
- **ä¸´æ—¶é…ç½®ç®¡ç†**ï¼šéç ´åæ€§çš„é…ç½®ä¿®æ”¹
- **å¤šæ¨¡å¼èåˆ**ï¼šäº¤äº’å¼å’Œå‘½ä»¤è¡Œæ¨¡å¼æ— ç¼ç»“åˆ

### 5.3 ç”¨æˆ·ä½“éªŒäº®ç‚¹
- **å¤šç§æ“ä½œæ–¹å¼**ï¼šGUIé£æ ¼çš„èœå• + ç°ä»£å‘½ä»¤è¡Œæ¥å£
- **æ™ºèƒ½è¾“å…¥å¤„ç†**ï¼šæ”¯æŒå•é€‰ã€æ‰¹é‡ã€åºåˆ—ç­‰å¤šç§è¾“å…¥
- **å‹å¥½é”™è¯¯å¤„ç†**ï¼šæ¸…æ™°çš„é”™è¯¯æç¤ºå’Œæ¢å¤æœºåˆ¶
- **è¿›åº¦åé¦ˆ**ï¼šå®æ—¶æ˜¾ç¤ºæ“ä½œçŠ¶æ€å’Œè¿›åº¦

### 5.4 å¼€å‘æ•ˆç‡
- **æ¨¡æ¿åŒ–å¼€å‘**ï¼šæä¾›äº†å®Œæ•´çš„å¼€å‘æ¨¡æ¿
- **æœ€ä½³å®è·µ**ï¼šå†…ç½®äº†é”™è¯¯å¤„ç†ã€èµ„æºç®¡ç†ç­‰æœ€ä½³å®è·µ
- **æ˜“äºæ‰©å±•**ï¼šæ–°åŠŸèƒ½å¯ä»¥å¿«é€Ÿé›†æˆåˆ°ç°æœ‰æ¡†æ¶ä¸­
- **æµ‹è¯•å‹å¥½**ï¼šæ¸…æ™°çš„æ¥å£è®¾è®¡ä¾¿äºå•å…ƒæµ‹è¯•

## å…­ã€ä½¿ç”¨ç¤ºä¾‹

### 6.1 åŸºç¡€ä½¿ç”¨
```bash
# å¯åŠ¨äº¤äº’å¼èœå•
python start.py

# ä½¿ç”¨æŒ‡å®šé…ç½®æ–‡ä»¶
python start.py --config my_config.json
```

### 6.2 æ¨¡å¼è®¾ç½®
```bash
# è®¾ç½®å¢é‡æ¨¡å¼
python start.py --incremental

# è®¾ç½®å…¨é‡æ¨¡å¼
python start.py --full

# è®¾ç½®è‡ªå®šä¹‰æ¨¡å¼
python start.py --custom
```

### 6.3 è‡ªåŠ¨æ‰§è¡Œ
```bash
# è‡ªåŠ¨æ‰§è¡Œåºåˆ—
python start.py --123450

# ç»„åˆä½¿ç”¨
python start.py --incremental --12a0

# ç­‰ä»·çš„ä¼ ç»Ÿæ–¹å¼
python start.py --auto 12a0
```

### 6.4 å®Œæ•´å‘½ä»¤è¡Œ
```bash
# å®Œæ•´çš„å‘½ä»¤è¡Œä½¿ç”¨
python main.py --config config.json --stocks --funds --indices --mode incremental
```

è¿™å¥—äº¤äº’å¼ç•Œé¢å®ç°æ–¹æ¡ˆæä¾›äº†ä»ç®€å•åˆ°å¤æ‚çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œæ—¢ä¿æŒäº†ä¼ ç»Ÿäº¤äº’å¼èœå•çš„å‹å¥½æ€§ï¼Œåˆæä¾›äº†ç°ä»£å‘½ä»¤è¡Œå·¥å…·çš„ä¾¿åˆ©æ€§ï¼Œæ˜¯Pythoné¡¹ç›®ç”¨æˆ·ç•Œé¢å¼€å‘çš„ä¼˜ç§€å‚è€ƒã€‚ 